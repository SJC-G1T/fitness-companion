<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weekly Fitness Companion</title>
    <meta name="theme-color" content="#ff4d7d">
    <meta name="apple-mobile-web-app-capable" content="true">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Fitness">
    <link rel="manifest" href="manifest.webmanifest">
    <style>
        :root {
            --color-primary: #ff4d7d;
            --color-primary-hover: #e63b6b;
            --color-success: #ff4d7d;
            --color-error: #ff4d7d;
            --color-bg: #0a0e1a;
            --color-surface: #1a1f2e;
            --color-text: #f5f5f5;
            --color-text-secondary: #b0b8c4;
            --color-border: rgba(255, 77, 125, 0.15);
            --spacing-16: 16px;
            --spacing-24: 24px;
            --spacing-32: 32px;
            --radius-lg: 12px;
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04);
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        html { background: #0a0e1a !important; height: 100% !important; }
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; 
            background: linear-gradient(135deg, #0a0e1a 0%, #1a1428 100%) !important; 
            color: var(--color-text); 
            padding: var(--spacing-16); 
            line-height: 1.5; 
            min-height: 100vh !important;
            margin: 0 !important;
        }
        .container { max-width: 500px; margin: 0 auto; }
        header { text-align: center; margin-bottom: var(--spacing-32); }
        h1 { font-size: 28px; font-weight: 600; margin-bottom: var(--spacing-16); letter-spacing: -0.01em; }
        .workout-selector { display: flex; gap: var(--spacing-16); margin-bottom: var(--spacing-24); justify-content: center; flex-wrap: wrap; }
        .workout-btn { padding: 10px 16px; border: 2px solid var(--color-border); background: var(--color-surface); border-radius: 8px; cursor: pointer; font-weight: 500; transition: all 0.25s ease; font-size: 14px; color: var(--color-text); }
        .workout-btn:hover { border-color: var(--color-primary); background: rgba(255, 77, 125, 0.15); }
        .workout-btn.active { background: var(--color-primary); color: white; border-color: var(--color-primary); box-shadow: 0 0 20px rgba(255, 77, 125, 0.4); }
        .timer-display { background: var(--color-surface); border-radius: var(--radius-lg); padding: var(--spacing-32); margin-bottom: var(--spacing-24); box-shadow: var(--shadow-md); border: 1px solid var(--color-border); }
        .phase-label { text-align: center; font-size: 14px; font-weight: 500; color: var(--color-text-secondary); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: var(--spacing-16); }
        .phase-label.warmup { color: #f59e61; }
        .phase-label.main { color: #ff4d7d; }
        .phase-label.cooldown { color: #a84f2f; }
        .time-display { font-size: 64px; font-weight: 600; text-align: center; font-variant-numeric: tabular-nums; margin: var(--spacing-24) 0; color: var(--color-primary); }
        .details-row { display: grid; grid-template-columns: 1fr 1fr; gap: var(--spacing-16); margin-bottom: var(--spacing-24); font-size: 14px; }
        .detail-box { background: rgba(255, 77, 125, 0.1); padding: var(--spacing-16); border-radius: 8px; border-left: 4px solid var(--color-primary); }
        .detail-label { font-size: 12px; color: var(--color-text-secondary); text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; }
        .detail-value { font-size: 18px; font-weight: 600; color: var(--color-text); }
        .controls { display: flex; gap: var(--spacing-16); margin-bottom: var(--spacing-24); flex-wrap: wrap; justify-content: center; }
        button { padding: 12px 24px; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.25s ease; font-size: 16px; flex: 1; min-width: 100px; }
        .btn-primary { background: var(--color-primary); color: white; font-weight: 700; }
        .btn-primary:hover:not(:disabled) { background: var(--color-primary-hover); box-shadow: 0 0 20px rgba(255, 77, 125, 0.5); }
        .btn-primary:active:not(:disabled) { transform: scale(0.98); }
        .btn-secondary { background: rgba(255, 77, 125, 0.1); color: var(--color-primary); border: 1px solid var(--color-border); }
        .btn-secondary:hover:not(:disabled) { background: rgba(255, 77, 125, 0.2); }
        .btn-danger { background: rgba(255, 77, 125, 0.15); color: var(--color-primary); border: 1px solid var(--color-border); }
        .btn-danger:hover:not(:disabled) { background: rgba(255, 77, 125, 0.25); }
        button:disabled { opacity: 0.5; cursor: not-allowed; }
        .instructions { background: rgba(255, 77, 125, 0.08); border-left: 4px solid var(--color-primary); padding: var(--spacing-16); border-radius: 8px; font-size: 13px; line-height: 1.6; color: var(--color-text-secondary); margin-bottom: var(--spacing-24); }
        .instructions strong { color: var(--color-text); }
        .sound-toggle { display: flex; align-items: center; gap: 8px; justify-content: center; margin-top: var(--spacing-16); font-size: 14px; }
        .checkbox { width: 20px; height: 20px; cursor: pointer; accent-color: var(--color-primary); }
        .main-content { display: flex; flex-direction: column; gap: var(--spacing-24); }
        .nutrition-section { background: rgba(255, 77, 125, 0.05); border-left: 4px solid #f59e61; padding: var(--spacing-16); border-radius: 8px; margin-bottom: var(--spacing-16); }
        .nutrition-title { font-weight: 600; color: #f59e61; margin-bottom: 8px; font-size: 13px; text-transform: uppercase; }
        .nutrition-item { font-size: 12px; color: var(--color-text-secondary); margin-bottom: 6px; line-height: 1.5; }
        .nutrition-item strong { color: var(--color-text); }
        @media (max-width: 480px) {
            .time-display { font-size: 56px; }
            h1 { font-size: 24px; }
            .controls { flex-direction: row; gap: 8px; }
            button { width: auto; flex: 1; padding: 10px 12px; font-size: 13px; }
            .details-row { grid-template-columns: 1fr; }
            .workout-selector { gap: 6px; }
            .workout-btn { padding: 8px 10px; font-size: 12px; }
            .timer-display { padding: var(--spacing-24); }
        }
        .recovery-panel { background: var(--color-surface); border-radius: var(--radius-lg); padding: var(--spacing-32); box-shadow: var(--shadow-md); border: 1px solid var(--color-border); }
        .recovery-card h2 { font-size: 22px; margin-bottom: var(--spacing-24); color: var(--color-primary); }
        .recovery-card p { margin-bottom: 12px; color: var(--color-text-secondary); font-size: 14px; line-height: 1.7; }
        .recovery-card strong { color: var(--color-text); }
        .workout-detail-card { background: var(--color-surface); border-radius: var(--radius-lg); padding: var(--spacing-32); box-shadow: var(--shadow-md); border: 1px solid var(--color-border); }
        .workout-phase { margin-bottom: var(--spacing-16); }
        .phase-title { font-weight: 600; color: var(--color-text); margin-bottom: 6px; }
        .phase-description { font-size: 13px; color: var(--color-text-secondary); margin-bottom: 8px; }
        .phase-details { font-size: 12px; color: var(--color-text-secondary); }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèãÔ∏è Weekly Fitness Companion</h1>
            <p style="color: var(--color-text-secondary); font-size: 14px;">Complete Training & Recovery Guide</p>
        </header>

        <div class="instructions" id="instructionsBox">
            <strong>How it works:</strong> Choose your day, hit Start, and the timer will guide you through warm-up ‚Üí main session ‚Üí cool-down automatically.
        </div>

        <div class="workout-selector">
            <button class="workout-btn active" data-day="monday">Mon</button>
            <button class="workout-btn" data-day="tuesday">Tue</button>
            <button class="workout-btn" data-day="wednesday">Wed</button>
            <button class="workout-btn" data-day="thursday">Thu</button>
            <button class="workout-btn" data-day="friday">Fri</button>
            <button class="workout-btn" data-day="saturday">Sat</button>
            <button class="workout-btn" data-day="sunday">Sun</button>
        </div>

        <div class="main-content">
            <div class="timer-display" id="timerDisplay" style="display: block;">
                <div class="phase-label" id="phaseLabel">Warm-up</div>
                <div class="time-display" id="timeDisplay">5:00</div>
                <div class="details-row">
                    <div class="detail-box">
                        <div class="detail-label">Current Phase</div>
                        <div class="detail-value" id="phaseDetail">Warm-up</div>
                    </div>
                    <div class="detail-box">
                        <div class="detail-label">Minute</div>
                        <div class="detail-value" id="minuteDetail">1/5</div>
                    </div>
                </div>
            </div>

            <div class="controls">
                <button class="btn-primary" id="startBtn" onclick="startWorkout()">Start</button>
                <button class="btn-secondary" id="pauseBtn" onclick="pauseWorkout()" disabled>Pause</button>
                <button class="btn-secondary" id="resumeBtn" onclick="resumeWorkout()" disabled style="display:none;">Resume</button>
                <button class="btn-danger" id="stopBtn" onclick="stopWorkout()" disabled>Stop</button>
                <button class="btn-secondary" id="restartBtn" onclick="restartWorkout()" disabled>Restart</button>
            </div>

            <div class="sound-toggle" id="soundToggle" style="display: flex;">
                <input type="checkbox" id="audioToggle" class="checkbox" checked>
                <label for="audioToggle" style="cursor: pointer; margin: 0;">Audio cues enabled</label>
            </div>

            <div class="recovery-panel" id="recoveryPanel" style="display: none;">
                <div class="recovery-card">
                    <h2 id="recoveryTitle">Recovery Day</h2>
                    <div id="recoveryContent" style="color: var(--color-text-secondary); font-size: 14px; line-height: 1.8;"></div>
                </div>
            </div>

            <div class="workout-detail-card" id="workoutDetailPanel" style="display: none;">
                <h2 id="workoutDetailTitle">Workout Details</h2>
                <div id="workoutDetailContent"></div>
                <div id="nutritionGuidance" style="margin-top: var(--spacing-24);"></div>
            </div>
        </div>
    </div>
    <script>
        const days = {
            monday: { type: 'workout', name: 'Monday - Full Body KB', emoji: 'üí™', phases: [{ name: 'Warm-up', duration: 300, description: 'Cat-cow, squats, arm circles', voicePrompt: 'Start your warmup' }, { name: 'EMOM (20 min)', duration: 1200, description: '10 KB Swings + 5 Goblet Squats per minute', voicePrompt: 'Begin main session' }, { name: 'Finisher', duration: 180, description: '3x Max Push-ups (rest 60s between)', voicePrompt: 'Finisher time' }], nutrition: { wake: '05:45 AM - 500ml water with electrolytes', preWorkout: 'Banana + 500ml water with electrolytes (30-45 mins before)', postWorkout: 'Whey protein 25-30g + 2 slices toast (within 30 mins)', breakfast: 'Eggs (high leucine for muscle growth)', hydration: '3-4L water by end of day', bed: '10:15 PM' } },
            tuesday: { type: 'workout', name: 'Tuesday - Cardio Intervals (Sprints)', emoji: 'üèÉ', phases: [{ name: 'Warm-up', duration: 300, description: '5 min easy jog', voicePrompt: 'Start your warmup' }, { name: 'Sprint Intervals', duration: 720, description: '8x (30s sprint + 90s easy)', voicePrompt: 'Ready for intervals', isCardio: true }], nutrition: { wake: '05:45 AM - 500ml water', preWorkout: 'Banana + electrolytes (high sodium for sweat loss)', postWorkout: 'Protein 25-30g + rice cakes (within 30 mins)', focus: 'Sodium replacement, high hydration', hydration: '4-5L water (increased sweat loss)', bed: '10:15 PM' } },
            wednesday: { type: 'workout', name: 'Wednesday - Armor Building Complex', emoji: '‚öôÔ∏è', phases: [{ name: 'Warm-up', duration: 300, description: '5 min light movement', voicePrompt: 'Start your warmup' }, { name: 'EMOM (15-20 min)', duration: 1020, description: '2 Cleans + 1 Press + 3 Front Squats', voicePrompt: 'Begin main session' }, { name: 'Accessory', duration: 300, description: '3x 10 Single-Arm KB Rows', voicePrompt: 'Accessory work' }], nutrition: { wake: '05:45 AM', preWorkout: 'Oatmeal + 500ml water with electrolytes (45 mins before)', postWorkout: 'Whey 25-30g + fruit (within 30 mins)', focus: 'Hypertrophy - higher protein tolerance post-workout', hydration: '3-4L water', bed: '10:15 PM' } },
            thursday: { type: 'recovery', name: 'Thursday - Active Recovery', emoji: 'üßò', tips: ['<strong>06:30 AM:</strong> Sleep in 45 mins extra - CNS recovery', '<strong>07:00 AM (15-min Mobility Flow):</strong> Hip circles, cat-cow, shoulder rolls, thoracic spine twists. Slow, controlled movements during kids breakfast.', '<strong>Workday - NEAT Focus:</strong> Take stairs instead of elevator. Stand at desk. Walk during calls. Park further away.', '<strong>06:30 PM - Evening Walk:</strong> 20-30 min gentle walk with family/dog. Aids digestion and blood sugar regulation.', '<strong>Nutrition - Light Protein:</strong> 20-25g per meal (eggs, Greek yogurt, chicken). Focus on prepping meals for Mon-Wed.', '<strong>Hydration:</strong> 3-4L water throughout day. No intense training.', '<strong>Sleep:</strong> 7-9 hours. Aim for 10:15 PM bed for CNS recovery.'], nutrition: { focus: 'Light protein (20-25g per meal)', hydration: '3-4L water', mealPrep: '3-4 hour meal prep session for Mon-Wed meals', sleep: '7-9 hours', activities: 'Mobility flow (15 mins), evening walk (20-30 mins), meal prep prep' } },
            friday: { type: 'workout', name: 'Friday - Grind & Conditioning', emoji: 'üî•', phases: [{ name: 'Warm-up', duration: 300, description: '5 min prep', voicePrompt: 'Start your warmup' }, { name: 'Ladder Protocol (10 min)', duration: 600, description: '1-10-1 KB Swings + Burpees', voicePrompt: 'Begin main session' }, { name: 'Core Work', duration: 300, description: '3x Plank + 3x Glute Bridges', voicePrompt: 'Cool down with core work' }], nutrition: { wake: '05:45 AM', preWorkout: 'Carbs + electrolytes (high intensity session)', postWorkout: 'Whey 25-30g + simple carbs (rice cakes, banana)', evening: 'Cheat meal allowed if protein-rich', hydration: '3-4L water', bed: '10:15 PM' } },
            saturday: { type: 'workout', name: 'Saturday - Endurance Run', emoji: 'üèÉ‚Äç‚ôÇÔ∏è', phases: [{ name: 'Warm-up', duration: 300, description: '5 min easy pace jog', voicePrompt: 'Start your warmup' }, { name: 'Long Run', duration: 2400, description: '40 mins steady conversational pace (Zone 2)', voicePrompt: 'Begin your long run' }, { name: 'Cool Down', duration: 300, description: '5 min easy walk or jog', voicePrompt: 'Cool down and stretch' }], nutrition: { wake: '07:00 AM', preWorkout: 'Banana (light carbs, no heavy protein)', during: 'Sip water every 20 mins if >45 mins', postWorkout: 'Protein 25-30g + complex carbs (replenish glycogen, 2:1 carb:protein)', focus: 'Recovery carbs for glycogen replenishment', hydration: '4L + during run', bed: '10:15 PM' } },
            sunday: { type: 'recovery', name: 'Sunday - Complete Rest', emoji: 'üò¥', tips: ['<strong>Morning:</strong> Sleep in. Family breakfast. No alarm clock.', '<strong>Activity:</strong> Leisurely family walk, swimming, or playing with kids. Light movement counts as NEAT.', '<strong>Meal Prep (3-4 hours):</strong> Batch cook meals for Mon-Wed. Focus on: Grilled chicken, rice, roasted vegetables, eggs, Greek yogurt.', '<strong>Nutrition - High Protein:</strong> 30-40g per meal. Light meals (maintenance calories). Focus: Prep quality ingredients.', '<strong>Hydration:</strong> 3L minimum water throughout day.', '<strong>Supplementation Setup:</strong> Organize electrolyte sachets, protein powder, creatine (5g daily) for the week.', '<strong>Preparation:</strong> Lay out workout clothes for Monday 5:45 AM. Charge fitness watch. Set alarm for 05:15 AM.', '<strong>Early Bed:</strong> 09:30 PM bedtime to prepare for Monday 5:45 AM wake-up and CNS recovery.'], nutrition: { meals: 'Light, maintenance calories. 30-40g protein per meal', hydration: '3L minimum', mealPrep: '3-4 hours batch cooking for Mon-Wed', supplementSetup: 'Organize: electrolytes, whey protein, creatine (5g daily)', sleep: 'Early bed 9:30 PM for Monday prep' } }
        };
        const workouts = {
            monday: { name: 'Monday - Full Body KB', phases: [{ name: 'Warm-up', duration: 300, description: 'Cat-cow, squats, arm circles', voicePrompt: 'Start your warmup' }, { name: 'EMOM (20 min)', duration: 1200, description: '10 KB Swings + 5 Goblet Squats per minute', voicePrompt: 'Begin main session' }, { name: 'Finisher', duration: 180, description: '3x Max Push-ups (rest 60s between)', voicePrompt: 'Finisher time' }] },
            tuesday: { name: 'Tuesday - Cardio Intervals (Sprints)', phases: [{ name: 'Warm-up', duration: 300, description: '5 min easy jog', voicePrompt: 'Start your warmup' }, { name: 'Sprint Intervals', duration: 720, description: '8x (30s sprint + 90s easy)', voicePrompt: 'Ready for intervals', isCardio: true }] },
            wednesday: { name: 'Wednesday - Armor Building Complex', phases: [{ name: 'Warm-up', duration: 300, description: '5 min light movement', voicePrompt: 'Start your warmup' }, { name: 'EMOM (15-20 min)', duration: 1020, description: '2 Cleans + 1 Press + 3 Front Squats', voicePrompt: 'Begin main session' }, { name: 'Accessory', duration: 300, description: '3x 10 Single-Arm KB Rows', voicePrompt: 'Accessory work' }] },
            friday: { name: 'Friday - Grind & Conditioning', phases: [{ name: 'Warm-up', duration: 300, description: '5 min prep', voicePrompt: 'Start your warmup' }, { name: 'Ladder Protocol (10 min)', duration: 600, description: '1-10-1 KB Swings + Burpees', voicePrompt: 'Begin main session' }, { name: 'Core Work', duration: 300, description: '3x Plank + 3x Glute Bridges', voicePrompt: 'Cool down with core work' }] },
            saturday: { name: 'Saturday - Endurance Run', phases: [{ name: 'Warm-up', duration: 300, description: '5 min easy pace jog', voicePrompt: 'Start your warmup' }, { name: 'Long Run', duration: 2400, description: '40 mins steady conversational pace (Zone 2)', voicePrompt: 'Begin your long run' }, { name: 'Cool Down', duration: 300, description: '5 min easy walk or jog', voicePrompt: 'Cool down and stretch' }] }
        };
        let currentDay = 'monday', currentPhaseIndex = 0, timeRemaining = 300, isRunning = false, isPaused = false, timerInterval = null;
        updateWorkoutDisplay();
        document.querySelectorAll('.workout-btn').forEach(btn => btn.addEventListener('click', (e) => {
            document.querySelectorAll('.workout-btn').forEach(b => b.classList.remove('active'));
            e.target.classList.add('active');
            currentDay = e.target.dataset.day;
            stopWorkout();
            currentPhaseIndex = 0;
            showDayView();
        }));
        function getDayData() { return days[currentDay]; }
        function showDayView() {
            const dayData = getDayData();
            if (dayData.type === 'workout') {
                document.getElementById('timerDisplay').style.display = 'block';
                document.getElementById('workoutDetailPanel').style.display = 'block';
                document.getElementById('recoveryPanel').style.display = 'none';
                document.getElementById('soundToggle').style.display = 'flex';
                document.getElementById('instructionsBox').innerHTML = `<strong>${dayData.emoji} ${dayData.name}:</strong> Choose your start time and the timer will guide you through warm-up ‚Üí main session ‚Üí cool-down automatically.`;
                updateWorkoutDisplay();
                showWorkoutDetails();
                showNutritionGuidance();
            } else {
                document.getElementById('timerDisplay').style.display = 'none';
                document.getElementById('workoutDetailPanel').style.display = 'none';
                document.getElementById('recoveryPanel').style.display = 'block';
                document.getElementById('soundToggle').style.display = 'none';
                showRecoveryTips();
            }
        }
        function showRecoveryTips() {
            const dayData = getDayData();
            document.getElementById('recoveryTitle').textContent = `${dayData.emoji} ${dayData.name}`;
            let html = dayData.tips.map(tip => `<p style="margin-bottom: 12px;">‚Ä¢ ${tip}</p>`).join('');
            if (dayData.nutrition) {
                html += '<div style="margin-top: 20px; border-top: 1px solid rgba(255,77,125,0.2); padding-top: 16px;"><strong style="color: #f59e61;">Nutrition & Hydration:</strong>';
                Object.entries(dayData.nutrition).forEach(([key, value]) => {
                    html += `<p style="margin: 8px 0; font-size: 13px; color: var(--color-text-secondary);"><strong>${key.charAt(0).toUpperCase() + key.slice(1)}:</strong> ${value}</p>`;
                });
                html += '</div>';
            }
            document.getElementById('recoveryContent').innerHTML = html;
        }
        function showWorkoutDetails() {
            const dayData = getDayData();
            const workout = getWorkoutData();
            document.getElementById('workoutDetailTitle').textContent = `${dayData.emoji} ${dayData.name} - Full Breakdown`;
            let html = '';
            workout.phases.forEach((phase, index) => {
                html += `<div class="workout-phase"><div class="phase-title">Phase ${index + 1}: ${phase.name}</div><div class="phase-description">${phase.description}</div><div class="phase-details"><strong>Duration:</strong> ${Math.floor(phase.duration / 60)} min ${phase.duration % 60} sec</div></div>`;
            });
            document.getElementById('workoutDetailContent').innerHTML = html;
        }
        function showNutritionGuidance() {
            const dayData = getDayData();
            if (!dayData.nutrition) return;
            let html = '<div style="margin-top: 24px; border-top: 1px solid rgba(255,77,125,0.2); padding-top: 16px;"><strong style="font-size: 16px; color: #f59e61; display: block; margin-bottom: 12px;">ü•ó Nutrition & Hydration</strong>';
            Object.entries(dayData.nutrition).forEach(([key, value]) => {
                const label = key.replace(/([A-Z])/g, ' $1').trim().split(' ').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
                html += `<div class="nutrition-section"><div class="nutrition-title">${label}</div><div class="nutrition-item">${value}</div></div>`;
            });
            html += '</div>';
            document.getElementById('nutritionGuidance').innerHTML = html;
        }
        function getWorkoutData() { return workouts[currentDay]; }
        function updateWorkoutDisplay() {
            const workout = getWorkoutData();
            const phase = workout.phases[currentPhaseIndex];
            document.getElementById('phaseLabel').textContent = phase.name;
            document.getElementById('phaseLabel').className = 'phase-label ' + (currentPhaseIndex === 0 ? 'warmup' : currentPhaseIndex === workout.phases.length - 1 ? 'cooldown' : 'main');
            document.getElementById('phaseDetail').textContent = phase.name;
            timeRemaining = phase.duration;
            updateDisplay();
        }
        function updateDisplay() {
            const minutes = Math.floor(timeRemaining / 60);
            const seconds = timeRemaining % 60;
            document.getElementById('timeDisplay').textContent = `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
            const workout = getWorkoutData();
            const totalMinutes = Math.ceil(workout.phases[currentPhaseIndex].duration / 60);
            const elapsed = workout.phases[currentPhaseIndex].duration - timeRemaining;
            const minute = Math.ceil(elapsed / 60) + 1;
            document.getElementById('minuteDetail').textContent = currentPhaseIndex === 0 ? 'Prep' : `${minute}/${totalMinutes}`;
        }
        function playBeep() {
            if (!document.getElementById('audioToggle').checked) return;
            try {
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.2);
            } catch (e) {}
        }
        function playVoicePrompt(text) {
            if (!document.getElementById('audioToggle').checked) return;
            window.speechSynthesis.cancel();
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 1.0;
            utterance.pitch = 1.0;
            utterance.volume = 0.9;
            window.speechSynthesis.speak(utterance);
        }
        function startWorkout() {
            const dayData = getDayData();
            if (dayData.type !== 'workout') {
                alert('This is a recovery day. No timer needed. Focus on the recovery tips instead!');
                return;
            }
            isRunning = true;
            isPaused = false;
            currentPhaseIndex = 0;
            updateWorkoutDisplay();
            document.getElementById('startBtn').disabled = true;
            document.getElementById('pauseBtn').disabled = false;
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('stopBtn').disabled = false;
            document.getElementById('restartBtn').disabled = false;
            document.querySelectorAll('.workout-btn').forEach(b => b.disabled = true);
            playBeep();
            const workout = getWorkoutData();
            playVoicePrompt(workout.phases[0].voicePrompt || 'Workout starting');
            runTimer();
        }
        function runTimer() {
            if (!isRunning || isPaused) return;
            timerInterval = setInterval(() => {
                if (!isRunning || isPaused) { clearInterval(timerInterval); return; }
                timeRemaining--;
                updateDisplay();
                if (currentPhaseIndex === 0 && timeRemaining === 30) playVoicePrompt('Warmup ending in 30 seconds. Get ready.');
                if (timeRemaining <= 0) {
                    playBeep();
                    currentPhaseIndex++;
                    const workout = getWorkoutData();
                    if (currentPhaseIndex >= workout.phases.length) { finishWorkout(); return; }
                    timeRemaining = workout.phases[currentPhaseIndex].duration;
                    updateWorkoutDisplay();
                    playBeep();
                    playVoicePrompt(workout.phases[currentPhaseIndex].voicePrompt || 'Next phase starting');
                }
            }, 1000);
        }
        function pauseWorkout() {
            isPaused = true;
            isRunning = false;
            document.getElementById('pauseBtn').style.display = 'none';
            document.getElementById('resumeBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('resumeBtn').disabled = false;
        }
        function resumeWorkout() {
            isPaused = false;
            isRunning = true;
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('pauseBtn').disabled = false;
            document.getElementById('resumeBtn').disabled = true;
            runTimer();
        }
        function stopWorkout() {
            isRunning = false;
            isPaused = false;
            clearInterval(timerInterval);
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('resumeBtn').disabled = true;
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('restartBtn').disabled = true;
            document.querySelectorAll('.workout-btn').forEach(b => b.disabled = false);
            currentPhaseIndex = 0;
            updateWorkoutDisplay();
        }
        function restartWorkout() { stopWorkout(); startWorkout(); }
        function finishWorkout() {
            isRunning = false;
            clearInterval(timerInterval);
            document.getElementById('timeDisplay').textContent = '‚úì Done!';
            document.getElementById('timeDisplay').style.color = 'var(--color-success)';
            document.getElementById('phaseLabel').textContent = 'Workout Complete';
            document.getElementById('startBtn').disabled = false;
            document.getElementById('pauseBtn').disabled = true;
            document.getElementById('pauseBtn').style.display = 'inline-block';
            document.getElementById('resumeBtn').style.display = 'none';
            document.getElementById('stopBtn').disabled = true;
            document.getElementById('restartBtn').disabled = false;
            document.querySelectorAll('.workout-btn').forEach(b => b.disabled = false);
            playVoicePrompt('Workout complete. Great session!');
            for (let i = 0; i < 3; i++) setTimeout(() => playBeep(), i * 300);
        }
    </script>
</body>
</html>
